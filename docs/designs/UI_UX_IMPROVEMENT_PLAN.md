# ワークフローエディタ UI/UX 改善プラン

## 概要

機能を維持しながら、情報設計を見直してUI/UXを最大化する改善プラン。

---

## 1. ヘッダーの再設計

### 現状の問題
- ボタンが多く並び、視覚的に煩雑
- プライマリ/セカンダリアクションの区別が弱い
- プロジェクト状態（公開済み/下書き）の視認性が低い

### 改善案

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│ [⚡] Project Name ▼          [ステータスバッジ]     │  [💾] [▶ 実行]  │  [⚙️] [👤] │
│  └─ 左寄せ                    └─ 公開済み v2        │   └─ グループ化  │  └─ 右端   │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

**変更点:**

| 要素 | Before | After |
|------|--------|-------|
| 保存ボタン | 「保存」「下書き保存」2つ | ドロップダウン付き単一ボタン |
| 自動整形 | テキストボタン | ツールバーアイコン（⚙️メニュー内） |
| 実行ボタン | 他と同列 | **強調表示**（プライマリカラー、大きく） |
| セカンダリメニュー | 3ボタン並列 | ⚙️歯車アイコンからドロップダウン |

### コンポーネント設計

```vue
<!-- EditorHeader.vue の改善 -->
<template>
  <header class="editor-header">
    <!-- Left: Project Info -->
    <div class="header-left">
      <EditorProjectSelector ... />
      <StatusBadge :status="project?.status" :version="project?.version" />
    </div>

    <!-- Center: Primary Actions -->
    <div class="header-center">
      <SaveDropdown @save="..." @saveDraft="..." @discard="..." />
      <RunButton @run="..." :loading="running" />
    </div>

    <!-- Right: Settings & User -->
    <div class="header-right">
      <SettingsDropdown>
        <DropdownItem @click="autoLayout">自動整形</DropdownItem>
        <DropdownItem @click="openRuns">実行履歴</DropdownItem>
        <DropdownItem @click="openSchedules">スケジュール</DropdownItem>
        <DropdownItem @click="openVariables">変数</DropdownItem>
      </SettingsDropdown>
      <UserMenu />
    </div>
  </header>
</template>
```

---

## 2. 左サイドバー（ブロックパレット）の改善

### 現状の問題
- カテゴリタブのラベルが切れる（「カス」→「カスタム」）
- ブロック説明が切れる
- アイテムの視覚的区別が弱い

### 改善案

**A. カテゴリタブ → アイコンタブに変更**

```
┌──────────────────────────────┐
│ [🤖] [⚡] [📱] [🔧]         │  ← アイコンのみ（ホバーでツールチップ）
│      AI  Flow App Custom     │
├──────────────────────────────┤
│ 🔍 ブロックを検索...    ⌘K  │
├──────────────────────────────┤
│ ▼ チャット (1)               │
│   ┌─────────────────────┐    │
│   │ ● LLM               │    │  ← カード形式、ホバーで詳細
│   └─────────────────────┘    │
│                              │
│ ▼ RAG (7)                    │
│   ● Document Loader          │
│   ● Embedding                │
│   ...                        │
└──────────────────────────────┘
```

**B. ブロックカードのコンパクト化**

```vue
<!-- Before -->
<div class="palette-item">
  <div class="item-color" />  <!-- 縦線 -->
  <div class="item-content">
    <div class="item-name">Document Loader</div>
    <div class="item-desc">Load documents from URL, text, or JS...</div>
  </div>
</div>

<!-- After: ホバーで詳細表示 -->
<div class="palette-item" @mouseenter="showTooltip" @mouseleave="hideTooltip">
  <div class="item-icon" :style="{ background: blockColor }">
    <BlockIcon :type="block.slug" />
  </div>
  <span class="item-name">{{ block.name }}</span>
  <Tooltip v-if="hovering">{{ block.description }}</Tooltip>
</div>
```

**C. 検索強化**

- リアルタイム検索結果プレビュー
- 最近使用したブロックセクション追加
- キーボードナビゲーション（↑↓でブロック選択、Enterで追加）

---

## 3. 右サイドバー（プロパティパネル）の再構成

### 現状の問題
- タブが5つと多い（設定、フロー、トリガー、Copilot、実行）
- 設定項目の優先度が不明確
- 情報が詰め込まれている

### 改善案

**A. タブの統合・削減**

| Before | After | 理由 |
|--------|-------|------|
| 設定 | **設定** | 維持（メイン） |
| フロー | **詳細設定** | 「設定」に統合、アコーディオン化 |
| トリガー | 設定に統合 | Startブロック選択時のみ表示 |
| Copilot | **アシスタント** ボタン | フローティングボタン化 |
| 実行 | **テスト** ボタン | ヘッダーまたはインライン化 |

**新しいタブ構成: 2タブ**
```
[ 設定 ] [ 詳細 ]
```

**B. 設定タブの情報階層化**

```
┌─────────────────────────────────────┐
│ ステップを編集                    X │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│ ● LLM Process                       │  ← ステップ名（インライン編集）
│ ─────────────────────────────────── │
│                                     │
│ [ 設定 ] [ 詳細 ]                   │
│                                     │
│ ┌─ モデル設定 ──────────────────┐  │
│ │ モデル:     [gpt-4      ▼]   │  │  ← 必須設定を上部に
│ │ プロバイダー: [OpenAI    ▼]   │  │
│ └───────────────────────────────┘  │
│                                     │
│ ┌─ プロンプト ──────────────────┐  │
│ │ ┌───────────────────────────┐│  │
│ │ │ Summarize the following   ││  │  ← 重要設定を展開状態で
│ │ │ data: {{$.message}}       ││  │
│ │ └───────────────────────────┘│  │
│ │                   123/60000  │  │
│ └───────────────────────────────┘  │
│                                     │
│ ▶ 出力スキーマ                      │  ← 省略可能な設定は折りたたみ
│ ▶ 高度な設定                        │
│                                     │
│ ─────────────────────────────────── │
│ [🗑️ 削除]              [💾 保存]   │
└─────────────────────────────────────┘
```

**C. 詳細タブ（旧フロータブ）**

```
┌─────────────────────────────────────┐
│ [ 設定 ] [ 詳細 ]                   │
│                                     │
│ ┌─ 入出力ポート ────────────────┐  │
│ │ 入力: input (any)             │  │
│ │ 出力: output (any) [default]  │  │
│ │       + ポートを追加           │  │
│ └───────────────────────────────┘  │
│                                     │
│ ▶ 前処理スクリプト (Prescript)      │
│ ▶ 後処理スクリプト (Postscript)     │
│                                     │
│ ┌─ エラーハンドリング ──────────┐  │
│ │ ☑ 有効                        │  │
│ │ リトライ: [3] 回 / [1] 秒間隔  │  │
│ │ タイムアウト: [60] 秒          │  │
│ └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

**D. Copilotのフローティング化**

```vue
<!-- 右下にフローティングボタン -->
<FloatingButton
  icon="sparkles"
  label="AI アシスタント"
  @click="openCopilotPanel"
/>

<!-- クリックでスライドアウトパネル -->
<SlideOutPanel v-model="showCopilot" title="AI アシスタント">
  <CopilotTab ... />
</SlideOutPanel>
```

---

## 4. DAGキャンバスの改善

### 現状の問題
- ノードが小さく情報量が少ない
- ステータス表示が弱い

### 改善案

**A. ノードデザインの強化**

```
Before:                      After:
┌────────────┐               ┌──────────────────┐
│ ● LLM      │               │ 🤖 LLM Process   │
│   Process  │       →       │ ─────────────────│
└────────────┘               │ gpt-4 • OpenAI   │  ← サブ情報
                             │ ✓ 設定済み        │  ← ステータス
                             └──────────────────┘
```

**B. エッジの視覚強化**

- 条件分岐時のラベル表示
- エラーポートは赤色
- 成功パスは緑色

**C. ミニマップの改善**

- 位置: 右下 → 左下（プロパティパネルと被らない）
- 折りたたみ可能
- 現在のビューポート範囲を強調表示

---

## 5. 全体的なビジュアル改善

### カラーパレットの統一

```css
:root {
  /* Primary */
  --color-primary: #3b82f6;        /* メインアクション */
  --color-primary-hover: #2563eb;

  /* Success/Run */
  --color-success: #10b981;         /* 実行成功、プレイボタン */

  /* Danger */
  --color-danger: #ef4444;          /* 削除、エラー */

  /* Neutral */
  --color-bg-primary: #ffffff;
  --color-bg-secondary: #f9fafb;
  --color-bg-tertiary: #f3f4f6;
  --color-border: #e5e7eb;
  --color-border-strong: #d1d5db;

  /* Text */
  --color-text-primary: #111827;
  --color-text-secondary: #6b7280;
  --color-text-tertiary: #9ca3af;
}
```

### スペーシングの統一

```css
:root {
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 24px;
  --space-2xl: 32px;
}
```

### ボーダーラジウスの統一

```css
:root {
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-xl: 12px;
}
```

---

## 6. インタラクションの改善

### キーボードショートカット

| ショートカット | アクション |
|---------------|----------|
| `⌘+S` | 保存 |
| `⌘+Shift+S` | 下書き保存 |
| `⌘+Enter` | 実行 |
| `⌘+K` | ブロック検索 |
| `⌘+/` | Copilot開く |
| `Delete` | 選択ステップ削除 |
| `Escape` | 選択解除 / パネル閉じる |

### マイクロインタラクション

- ボタンホバー時のスケール変化
- パネル開閉時のスムーズなトランジション
- 保存成功時のトースト通知
- ドラッグ中のカーソル変化

---

## 実装優先度

### Phase 1: 高インパクト・低コスト
1. ヘッダーのボタングループ化（SaveDropdown）
2. プロパティパネルのタブ統合（5→2タブ）
3. カテゴリタブのアイコン化

### Phase 2: 中インパクト・中コスト
4. ブロックカードのコンパクト化
5. Copilotのフローティング化
6. キーボードショートカット追加

### Phase 3: 高インパクト・高コスト
7. ノードデザインの強化
8. 全体的なカラーパレット統一
9. アニメーション・トランジション追加

---

## 検証方法

### ユーザビリティテスト項目

1. **タスク完了時間**
   - 新規ワークフロー作成（5ステップ）
   - 既存ステップの設定変更
   - ワークフロー実行

2. **エラー率**
   - 誤クリック数
   - やり直し回数

3. **主観評価**
   - 使いやすさ（1-5）
   - 見やすさ（1-5）
   - 全体的な満足度（1-5）

---

## 参考デザイン

- Figma（ワイヤーフレーム）
- n8n（ワークフローエディタ）
- Retool Workflows
- Linear（UIの洗練さ）
